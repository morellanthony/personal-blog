<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>CVE-2025-29513: Stored XSS in NodeBB Admin API token generator - Tony&#39;s Cybersecurity Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Stored XSS attack in the Admin API token generation of NodeBB CMS" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="http://localhost:1313/posts/cve-2025-29513/">
  <meta property="og:site_name" content="Tony&#39;s Cybersecurity Blog">
  <meta property="og:title" content="CVE-2025-29513: Stored XSS in NodeBB Admin API token generator">
  <meta property="og:description" content="Stored XSS attack in the Admin API token generation of NodeBB CMS">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-15T02:01:58+05:30">
    <meta property="article:modified_time" content="2025-04-15T02:01:58+05:30">
    <meta property="article:tag" content="CVE">
    <meta property="article:tag" content="XSS">
    <meta property="article:tag" content="NodeBB">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE-2025-29513: Stored XSS in NodeBB Admin API token generator">
  <meta name="twitter:description" content="Stored XSS attack in the Admin API token generation of NodeBB CMS">
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css"  disabled />
	

	
	

	
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">Tony&#39;s Cybersecurity Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All Posts</a>
		
		<a href="/about">About</a>
		
		<a href="/tags">Tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">CVE-2025-29513: Stored XSS in NodeBB Admin API token generator</h1>
			<div class="meta">Posted on Apr 15, 2025</div>
		</div>
		

		

		<section class="body">
			<h1 id="overview">Overview</h1>
<p>CVE-2025-29513 is a stored cross-site scripting (XSS) vulnerability in the Admin API token generator functionality of NodeBB version 4.0.4 and below. This flaw allows an attacker with administrative access to inject arbitrary JavaScript through crafted input in the User ID (uid) field when generating new API tokens.</p>
<p>Although the frontend input form enforces numeric validation, an attacker can bypass these restrictions by using tools like cURL or a web proxy to submit values such as -0 or malformed numeric strings (e.g., -0000.00). These inputs are not properly validated server-side and are reflected in the rendered HTML of the admin panel, leading to persistent script injection.</p>
<p>Once a malicious payload is stored, it is rendered every time the admin accesses the API tokens page, enabling a stored XSS attack. This vulnerability can be abused to hijack admin sessions, escalate privileges, or cause application instability.</p>
<h1 id="steps">Steps</h1>
<ol>
<li>
<p>Sign in as a <strong>privileged user</strong>, such as an administrator, and navigate to the <code>/admin/settings/api</code> endpoint.</p>
</li>
<li>
<p><strong>Observe the token creation process:</strong></p>
<ul>
<li>To create a token, click the <strong>&ldquo;Create Token&rdquo;</strong> button within the <strong>API Access</strong> section.</li>
<li>Enter a legal value such as <code>&quot;0&quot;</code>.</li>
<li>Note the assigned user ID.</li>
</ul>
<p><img src="/images/CVE-2025-29513/XSS-1.png" alt="XSS" title="XSS"><br>
<img src="/images/CVE-2025-29513/XSS-2.png" alt="XSS" title="XSS"><br>
<img src="/images/CVE-2025-29513/XSS-3.png" alt="XSS" title="XSS"><br>
<img src="/images/CVE-2025-29513/XSS-4.png" alt="XSS" title="XSS"></p>
</li>
<li>
<p>The value <code>&quot;0&quot;</code> is particularly <strong>interesting</strong> because it is assigned as a <strong>Master Token</strong> in the API token generator. As values are assigned in the <strong>User</strong> field of the token, they correlate to specific user IDs.</p>
<ul>
<li>For example, in my local instance, the <code>admin</code> user has an ID of <code>1</code>. Therefore, if I create a token with the <strong>User</strong> field set to <code>1</code>, it would be assigned to <code>admin</code>.</li>
</ul>
<p>A notable aspect of this assigned value is that a user can enter <code>&quot;-0&quot;</code> using a <strong>web proxy</strong> or a tool like <strong>cURL</strong>.</p>
<ul>
<li>This does <strong>not</strong> work when entering it from the frontend due to <strong>input sanitization rules</strong> that prevent such values.</li>
<li>However, the <strong>backend does not enforce these restrictions</strong>, allowing us to submit <code>-0</code> and see it reflected in the application.</li>
</ul>
<p><img src="/images/CVE-2025-29513/XSS-5.png" alt="XSS" title="XSS"><br>
<img src="/images/CVE-2025-29513/XSS-6.png" alt="XSS" title="XSS"></p>
</li>
<li>
<p>Once the value <code>-0</code> is processed, an attacker can continue submitting values. Although the backend appears to reject some inputs, <strong>they still appear in the application</strong>.</p>
<p><img src="/images/CVE-2025-29513/XSS-7.png" alt="XSS" title="XSS"><br>
<img src="/images/CVE-2025-29513/XSS-8.png" alt="XSS" title="XSS"></p>
</li>
<li>
<p>Now that the application has <strong>confirmed HTML injection</strong>, the next step is to attempt injecting script tags for an <strong>XSS attack</strong>:</p>
<p><code>&lt;script&gt;alert(&quot;NodeBB Hacked!&quot;)&lt;/script&gt;</code></p>
<p>It is also worth noting that the application <strong>accepts other variations of <code>-0</code></strong>, such as <code>-00000</code> or <code>-000000.00000000</code>.</p>
<p><img src="/images/CVE-2025-29513/XSS-9.png" alt="XSS" title="XSS"><br>
<img src="/images/CVE-2025-29513/XSS-10.png" alt="XSS" title="XSS"></p>
</li>
</ol>
<h1 id="further-analysis-code-review">Further Analysis: Code Review</h1>
<h4 id="srcapiutilsjs"><code>src/api/utils.js</code></h4>
<pre><code>This file includes a few new updates not shown in the previous code snippets. Notably, an error is thrown if an invalid ID is entered. Another key adjustment is the use of piped characters to validate whether the entered `uid` is a number. In this context, `uid` represents the token, so any non-numeric characters after the initial `uid` should be considered invalid upon entry. However, in theory, this should not prevent the input of `-0` if `isNumber` still recognizes it as a valid number. 
</code></pre>
<h4 id="srcviewsadminpartialsedit-token-modaltpl"><code>src/views/admin/partials/edit-token-modal.tpl</code></h4>
<pre><code>The updates in this file involve modifying the `uid` and `description` parameters within the input tagâ€™s `id` attribute. Since the vulnerability was found in the `uid` parameter, the input type has been set to `number` to reinforce security measures. These changes enhance validation by strengthening both frontend and backend protections.  
</code></pre>
<hr>
<h2 id="the-fix">The Fix</h2>
<p><strong>src/api/utils.js</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">utils</span>.<span style="color:#a6e22e">tokens</span>.<span style="color:#a6e22e">add</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> ({ <span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">uid</span>, <span style="color:#a6e22e">description</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#a6e22e">timestamp</span> <span style="color:#f92672">=</span> Date.<span style="color:#a6e22e">now</span>() }) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">token</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">uid</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">undefined</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">srcUtils</span>.<span style="color:#a6e22e">isNumber</span>(<span style="color:#a6e22e">uid</span>)) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;[[error:invalid-data]]&#39;</span>);
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><p><strong>src/views/admin/partials/edit-token-modal.tpl</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">form</span> <span style="color:#a6e22e">role</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mb-3&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">label</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-label&#34;</span> <span style="color:#66d9ef">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;uid&#34;</span><span style="color:#f92672">&gt;</span>[[<span style="color:#a6e22e">admin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">settings</span><span style="color:#f92672">/</span><span style="color:#a6e22e">api</span><span style="color:#f92672">:</span><span style="color:#a6e22e">uid</span>]]<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">input</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;uid&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;number&#34;</span> <span style="color:#a6e22e">inputmode</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;numeric&#34;</span> <span style="color:#a6e22e">pattern</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;\d+&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;uid&#34;</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-control&#34;</span> <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{./uid}&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-text&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            [[<span style="color:#a6e22e">admin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">settings</span><span style="color:#f92672">/</span><span style="color:#a6e22e">api</span><span style="color:#f92672">:</span><span style="color:#a6e22e">uid</span><span style="color:#f92672">-</span><span style="color:#a6e22e">help</span><span style="color:#f92672">-</span><span style="color:#a6e22e">text</span>]]
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mb-3&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">label</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-label&#34;</span> <span style="color:#66d9ef">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">&gt;</span>[[<span style="color:#a6e22e">admin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">settings</span><span style="color:#f92672">/</span><span style="color:#a6e22e">api</span><span style="color:#f92672">:</span><span style="color:#a6e22e">description</span>]]<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/label&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">input</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;description&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;description&#34;</span> <span style="color:#66d9ef">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;form-control&#34;</span> <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Description&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{./description}&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/form&gt;</span>
</span></span></code></pre></div><p><strong>For more information, the git commit can be found <a href="https://github.com/NodeBB/NodeBB/commit/80cc1d34b08357ec089366883e5d7dcdac6ebb46">here</a>.</strong></p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/cve">CVE</a></li>
					
					<li><a href="/tags/xss">XSS</a></li>
					
					<li><a href="/tags/nodebb">NodeBB</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex">
    Social:<a class="soc" href="https://github.com/morellanthony" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://www.linkedin.com/in/morellanthony/" rel="me" title="LinkedIn"><i data-feather="linkedin"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
   2025  Anthony Morell 
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
