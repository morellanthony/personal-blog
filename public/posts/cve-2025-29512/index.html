<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>CVE-2025-29512: Stored XSS in the blacklist IP functionality - Tony&#39;s Cybersecurity Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Stored XSS attack in the blacklist IP functionality of NodeBB CMS" />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="http://localhost:1313/posts/cve-2025-29512/">
  <meta property="og:site_name" content="Tony&#39;s Cybersecurity Blog">
  <meta property="og:title" content="CVE-2025-29512: Stored XSS in the blacklist IP functionality">
  <meta property="og:description" content="Stored XSS attack in the blacklist IP functionality of NodeBB CMS">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-15T02:01:57+05:30">
    <meta property="article:modified_time" content="2025-04-15T02:01:57+05:30">
    <meta property="article:tag" content="CVE">
    <meta property="article:tag" content="XSS">
    <meta property="article:tag" content="NodeBB">
    <meta property="article:tag" content="Bug Bounty">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE-2025-29512: Stored XSS in the blacklist IP functionality">
  <meta name="twitter:description" content="Stored XSS attack in the blacklist IP functionality of NodeBB CMS">
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.d22e2a2879d933a4b781535fc4c4c716e9f9d35ea4986dd0cbabda82effc4bdd.css"  disabled />
	

	
	

	
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">Tony&#39;s Cybersecurity Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All Posts</a>
		
		<a href="/about">About</a>
		
		<a href="/tags">Tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="http://localhost:1313/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">CVE-2025-29512: Stored XSS in the blacklist IP functionality</h1>
			<div class="meta">Posted on Apr 15, 2025</div>
		</div>
		

		

		<section class="body">
			<h1 id="overview">Overview</h1>
<p>CVE-2025-29512 is a stored cross-site scripting (XSS) vulnerability affecting NodeBB version 4.0.4 and below. The issue resides in the IP blacklist administration panel <code>/ip-blacklist</code>, where input provided to the &ldquo;rules&rdquo; <code>&lt;textarea&gt;</code> is improperly sanitized. When a moderator inputs malicious HTML or JavaScript, the payload is stored and executed upon subsequent visits to the page.</p>
<p>This vulnerability allows moderators to execute arbitrary JavaScript in the context of other privileged users, leading to potential session hijacking, defacement, or unauthorized administrative actions. Since the injected script persists across sessions and there is no built-in mechanism to sanitize or remove the stored payload from the UI, exploitation can lead to persistent denial of access to the page or further abuse.</p>
<p>The issue has been addressed by the NodeBB team in a GitHub commit, where user-supplied input is now sanitized using the validator.escape() function to neutralize HTML special characters.</p>
<h1 id="steps">Steps</h1>
<ol>
<li>
<p><strong>Create a normal user</strong> and <strong>promote or ensure the user is a moderator</strong>.</p>
</li>
<li>
<p>Navigate to <code>/ip-blacklist</code>.</p>
</li>
<li>
<p>Enter the payload <code>&lt;/textarea&gt;&lt;script&gt;alert(“NodeBB Hacked!”)&lt;/script&gt;</code>.</p>
</li>
<li>
<p>Click the <strong>&ldquo;Apply Blacklist&rdquo;</strong> button.</p>
</li>
<li>
<p>Refresh the page and observe the <strong>XSS Proof of Concept (PoC)</strong>.</p>
<p><img src="/images/CVE-2025-29512/XSS-1.png" alt="XSS" title="XSS"></p>
</li>
<li>
<p>Once you navigate back to the page, the <strong>script tags will be embedded into the page</strong>.</p>
<ul>
<li>To <em>possibly</em> remove the tags, simply click the <strong>&ldquo;Apply Blacklist&rdquo;</strong> button again with an <strong>arbitrary IP value</strong>.</li>
</ul>
</li>
<li>
<p><strong>Side note:</strong> You can also <strong>deny access to this page</strong> with other <strong>HTML injection attacks</strong>.<br>
I found two ways to remove the injected data:</p>
<ol>
<li>
<p>Host another page I never reloaded that had the <strong>&ldquo;Apply Blacklist&rdquo;</strong> button. This would be used to <strong>cleanse</strong> the endpoint of any injections.</p>
</li>
<li>
<p>Manually delete the <code>ip-blacklist-rules</code> field in the <strong>MongoDB database</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>db.objects.deleteOne({ _key: &#34;ip-blacklist-rules&#34; });
</span></span></code></pre></div></li>
</ol>
<ul>
<li>
<p>There appears to be <strong>no built-in way</strong> to remove the script tags once embedded into the <code>&lt;textarea&gt;</code>, and the <strong>API does not manage IP blacklists</strong>. As a result, every time I navigated to the page, I could not make changes and encountered the following issue which removed functionality of the application.</p>
<p><img src="/images/CVE-2025-29512/XSS-2.png" alt="XSS" title="XSS"></p>
</li>
</ul>
</li>
</ol>
<h1 id="further-analysis-code-review">Further Analysis: Code Review</h1>
<p>Exploiting a vulnerability is one thing, but understanding the design and the fix for the issue is an entirely different skill.</p>
<p>After reporting the vulnerability to the security team, the developers chose to mitigate the issue by incorporating the <code>validator</code> npm package. This package includes a function called <code>validator.escape</code>. According to the npm documentation, the <code>escape</code> function performs the following transformation:</p>
<table>
  <thead>
      <tr>
          <th><strong>Function</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>escape(input)</code></td>
          <td>replace &lt;, &gt;, &amp;, &lsquo;, &quot; and / with HTML entities.</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="the-fix">The Fix</h2>
<p>The developers passed the user-provided <code>rules</code> data through <code>validator.escape</code> to sanitize it. Additionally, the data was wrapped with the <code>String()</code> function to ensure it is always converted to a string data type.</p>
<p><code>src/controllers/globalmods.js</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#e6db74">&#39;use strict&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">validator</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;validator&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;../user&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">meta</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;../meta&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">analytics</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;../analytics&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;ip-blacklist&#39;</span>, {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;[[pages:ip-blacklist]]&#39;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">rules</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">escape</span>(String(<span style="color:#a6e22e">rules</span>)),
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">analytics</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">analyticsData</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">breadcrumbs</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">helpers</span>.<span style="color:#a6e22e">buildBreadcrumbs</span>([{ <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;[[pages:ip-blacklist]]&#39;</span> }]),
</span></span><span style="display:flex;"><span>	});
</span></span></code></pre></div><p><strong>For more information, the git commit can be found <a href="https://github.com/NodeBB/NodeBB/commit/625f47514f6271df09d0678f0e343c60fedf15dd">here</a>.</strong></p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/cve">CVE</a></li>
					
					<li><a href="/tags/xss">XSS</a></li>
					
					<li><a href="/tags/nodebb">NodeBB</a></li>
					
					<li><a href="/tags/bug-bounty">Bug Bounty</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex">
    Social:<a class="soc" href="https://github.com/morellanthony" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://www.linkedin.com/in/morellanthony/" rel="me" title="LinkedIn"><i data-feather="linkedin"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
   2025  Anthony Morell 
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
